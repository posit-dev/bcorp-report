---
title: "2024 B-corp graphs"
format: html
editor: visual
---

```{r}
#| echo: false
options(scipen = 999)

library(ggplot2)
library(tidyverse)
pydf <- read.csv("pypi_stats.csv", col.names = c("date", "downloads", "pkg"))
rdf <- read.csv("rpkgs.csv", col.names = c("date", "downloads", "pkg"))
tidyvdf <- read.csv("tidyverse_pkgs.csv", col.names = c("date", "downloads", "pkg"))
tidymdf <- read.csv("tidymodels_pkgs.csv", col.names = c("date", "downloads", "pkg"))
rlibdf <- read.csv("rlib_pkgs.csv", col.names = c("date", "downloads", "pkg"))
rcondf <- read.csv("rcon_pkgs.csv", col.names = c("date", "downloads", "pkg"))

rstudiodf <- read.csv("rstudio_os_dls.csv", col.names = c("date", "downloads"))
rstudiodf$pkg <- "RStudio"

singlepltfunc <- function(df, package) {
  
  return(
    df %>% 
    filter(pkg == package) %>%
    ggplot(aes(x=as.Date(date), y=cumsum(downloads))) + geom_line() +  scale_x_date(labels=scales::label_date_short()) + xlab("Date") + ylab("Cumulative Downloads") + ggtitle(package) + theme_minimal() + scale_y_continuous(labels = scales::comma)
  )
}
```

## Quarto

```{r}
#| echo: false

#singlepltfunc(pydf, "siuba")
```

## Shiny

```{r}
#| echo: false
#TODO: should we stack these into a single graph?
singlepltfunc(pydf, "shiny")
singlepltfunc(rdf, "shiny")
```

## gt / great tables

```{r}
#| echo: false
#TODO: stack these into a single graph? clean up x axis date range
singlepltfunc(pydf, "great_tables")
singlepltfunc(rdf, "gt")
```

## Vetiver

```{r}
#| echo: false
#TODO: stack these into a single graph? clean up x axis date range
singlepltfunc(pydf, "vetiver")
singlepltfunc(rdf, "vetiver")
```

## Plotnine

```{r}
#| echo: false
singlepltfunc(pydf, "plotnine")
```

## Siuba

```{r}
#| echo: false
singlepltfunc(pydf, "siuba")
```

## Rstudio

```{r}
#| echo: false
singlepltfunc(rstudiodf, "RStudio")
```

## Tidyverse

```{r}
#| echo: false
tidyvdf %>% 
  group_by(date) %>% 
  summarise(downloads = sum(downloads)) -> tidyvdf
tidyvdf$pkg <- "Tidyverse"
  
singlepltfunc(tidyvdf, "Tidyverse")
```

## Tidymodels

```{r}
#| echo: false
tidymdf %>% 
  group_by(date) %>% 
  summarise(downloads = sum(downloads)) -> tidymdf
tidymdf$pkg <- "Tidymodels"
  
singlepltfunc(tidymdf, "Tidymodels")
```

## Connectivity

```{r}
#| echo: false

rcondf %>% 
  group_by(date) %>% 
  summarise(downloads = sum(downloads)) -> rcondf
rcondf$pkg <- "R Connectivity"
  
singlepltfunc(rcondf, "R Connectivity")
```

## R-lib

```{r}
#| echo: false

rlibdf %>% 
  group_by(date) %>% 
  summarise(downloads = sum(downloads)) -> rlibdf
rlibdf$pkg <- "R-Lib"
  
singlepltfunc(rlibdf, "R-Lib")
```
